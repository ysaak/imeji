{% extends "layout" %}

{% block sidebar %}
<aside class="sidebar p-3">
    <div class="row">
        {% for color in wallpaper.palette %}
        <a href="/search?q=color:{{ color.color }}" class="col border text-decoration-none" style="background-color: #{{ color.color }}">&nbsp;</a>
        {% endfor %}
    </div>

    <div class="mt-3">
        <h3>Tags</h3>
        <ul class="list-unstyled">
            {% for tag in wallpaper.tags %}
            <li>{{ tag_link(tag) }}</li>
            {% endfor %}
        </ul>

        <h3>Data</h3>
        <ul class="list-unstyled">
            <li>Original size : {{ wallpaper.width }} x {{ wallpaper.height }}</li>
            <li>File size : {{ file_size(wallpaper.fileSize) }}</li>
            <li><a href="/wallpapers/full/{{ wallpaper.id }}.png">Original file</a></li>
        </ul>

        <h3>Tools</h3>
        <ul class="list-unstyled">
            <li><a href="#" data-bs-toggle="modal" data-bs-target="#editWallpaper">Edit</a></li>
        </ul>
    </div>
</aside>
{% endblock %}

{% block content %}
    <div id="showcase" class="fit">
        <img src="/wallpapers/full/{{ wallpaper.id }}.png" id="wallpaper" width="{{ wallpaper.width }}" height="{{ wallpaper.height }}">
    </div>
{% endblock %}

{% block modals %}
<div class="modal fade" tabindex="-1" id="editWallpaper">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Edit wallpaper</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form method="post" action="/w/{{ wallpaper.id }}">
                <input type="hidden" name="id" value="{{ wallpaper.id }}">
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="wallTags" class="form-label">Tags:</label>
                        <textarea class="form-control" id="wallTags" name="tags" rows="3">{% if editTags %}{{ editTags }}{% else %}{% for tag in wallpaper.tags %}{{ tag.name }} {% endfor %}{% endif %}</textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Save changes</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
    document.getElementById("wallpaper").addEventListener("click", function() {
        var showcaseTag = document.getElementById("showcase");

        if (showcaseTag.classList.contains("fit")) {
            showcaseTag.classList.replace("fit", "fill");
        }
        else if (showcaseTag.classList.contains("fill")) {
            showcaseTag.classList.replace("fill", "full");
        }
        else {
            showcaseTag.classList.replace("full", "fit");
        }
    });
});
</script>
{% endblock %}